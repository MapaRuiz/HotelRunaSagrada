<section class="room-detail">
  <!-- ===== Hero 100vh con autoplay ===== -->
  <div class="hero-full">
    <!-- stage / fondos -->
    <div class="hero-stage">
      <div
        class="hero-bg"
        *ngFor="let url of slides; let i = index"
        [class.active]="i === currentSlide"
        [style.backgroundImage]="
          'linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)), url(' + url + ')'
        "
      ></div>
    </div>

    <!-- overlay -->
    <div class="hero-overlay">
      <span class="eyebrow">HABITACIÓN</span>

      <!-- TÍTULO con animación en tipo + tema SIEMPRE que cambia el slide -->
      <h1 class="hero-title" [class.fill-animate]="titleAnim">
        <span class="t">{{ typeName }}</span> — <span class="theme">{{ themeName }}</span>
      </h1>

      <p class="hero-loc">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path
            d="M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm0 9.5A2.5 2.5 0 1 1 12 6a2.5 2.5 0 0 1 0 5.5z"
          />
        </svg>
        {{ hotelName || 'Hotel #' + hotelId }}
      </p>

      <button
        class="hero-cta"
        (click)="reserveSection?.scrollIntoView({ behavior: 'smooth', block: 'start' })"
      >
        Ver habitaciones
      </button>

      <!-- dots -->
      <div class="hero-dots" *ngIf="slides.length > 1">
        <button
          *ngFor="let _ of slides; let i = index"
          [class.active]="i === currentSlide"
          (click)="goTo(i)"
          aria-label="Ir al slide {{ i + 1 }}"
        ></button>
      </div>
    </div>
  </div>

  <!-- ===== Copys y chips ===== -->
  <div class="container">
    <p class="desc">{{ description }}</p>

    <div class="chips">
      <span class="chip" *ngIf="basePrice">
        <span class="k">Desde</span>
        <span class="v">{{ basePrice | currency : 'COP' : 'symbol' : '1.0-0' }}</span>
      </span>
      <span class="chip" *ngIf="capacity">
        <span class="k">Capacidad</span>
        <span class="v">{{ capacity }}</span>
      </span>
      <span class="chip">
        <span class="k">{{
          selectedCheckIn && selectedCheckOut ? 'Disponibles' : 'Disponibles hoy'
        }}</span>
        <span class="v">{{ availableCount }}</span>
      </span>
      <span class="chip">
        <span class="k">Reservadas</span>
        <span class="v">{{ bookedCount }}</span>
      </span>
      <span class="chip">
        <span class="k">Mantenimiento</span>
        <span class="v">{{ maintenanceCount }}</span>
      </span>
    </div>

    <!-- ===== Grid listado + aside ===== -->
    <div class="content-grid">
      <div class="main-col">
        <h3>Habitaciones de este tipo en el hotel</h3>
        <ul class="room-list">
          <li
            class="room-card reveal"
            *ngFor="let r of rooms; trackBy: trackByRoom; let i = index"
            [style.--i]="i"
          >
            <div class="room-left">
              <strong>{{ r.number }}</strong>
              <span class="muted">Piso {{ r.floor }}</span>
            </div>

            <div class="room-right">
              <span
                class="status-chip"
                [class.avail]="isAvailable(r)"
                [class.booked]="isBooked(r)"
                [class.maint]="isMaintenance(r)"
              >
                {{ statusLabel(r) }}
              </span>
            </div>
          </li>
        </ul>
      </div>

      <aside class="aside-col" #reserveSection>
        <app-room-form
          (reservationCreated)="onReservationCreated($event)"
          (datesChanged)="onDatesChanged($event)"
        >
        </app-room-form>
      </aside>
    </div>

    <app-room-gallery
      class="mt-6"
      [hotelName]="hotelName"
      [plantBg]="'https://images.pexels.com/photos/2215534/pexels-photo-2215534.jpeg'"
      [images]="[
        'https://images.pexels.com/photos/1231365/pexels-photo-1231365.jpeg',
        'https://images.pexels.com/photos/39691/family-pier-man-woman-39691.jpeg',
        'https://images.pexels.com/photos/3155726/pexels-photo-3155726.jpeg',
        'https://images.pexels.com/photos/61129/pexels-photo-61129.jpeg',
        'https://images.pexels.com/photos/18160731/pexels-photo-18160731.jpeg',
        'https://images.pexels.com/photos/13767906/pexels-photo-13767906.jpeg'
      ]"
      [columns]="3"
      [cardW]="300"
      [cardH]="200"
    >
    </app-room-gallery>

    <app-room-rv
      [title]="'Recorrido virtual de la habitación'"
      [src]="'https://my.matterport.com/show/?m=dTDqi6RDy29&play=1&guides=1&brand=0'"
    >
    </app-room-rv>
  </div>
  <app-footer></app-footer>
</section>
